/*
 * gee.js - http://georgealways.github.com/gee
 * 
 * George Michael Brower - http://georgemichaelbrower.com
 * Jono Brandel - http://jonobr1.com
 */
window.GEE=function(d){d||(d={});if(document.createElement("canvas").getContext){var b=this,i={},c={ctx:undefined,domElement:undefined,width:undefined,height:undefined,desiredFrameTime:1E3/60,frameCount:0,key:undefined,keyCode:undefined,mouseX:0,mouseY:0,pmouseX:undefined,pmouseY:undefined,mousePressed:false},j=undefined,f,h=function(){for(var a=f,g=0,m=0;a;){m+=a.offsetTop;g+=a.offsetLeft;a=a.offsetParent}offset={x:g,y:m}};d.context||(d.context="2d");f=c.domElement=document.createElement("canvas");
c.ctx=f.getContext(d.context);if(c.ctx==null)d.fallback&&d.fallback();else{if(d.fullscreen){var e=function(){h();c.width=d.width?f.width=d.width:f.width=window.innerWidth;c.height=d.height?f.height=d.height:f.height=window.innerHeight;b.loop||b.draw&&b.draw()};window.addEventListener("resize",e,false);e();if(!d.container){document.body.style.margin="0px";document.body.style.padding="0px";document.body.style.overflow="hidden"}d.container=d.container||document.body}else{d.width||(d.width=500);d.height||
(d.height=500);window.addEventListener("resize",h,false);h();b.__defineSetter__("width",function(a){c.width=f.width=a});b.__defineSetter__("height",function(a){c.height=f.height=a});b.width=d.width;b.height=d.height}if(d.container){d.container.appendChild(f);h()}e=function(a){b.__defineGetter__(a,function(){return c[a]})};e("ctx");e("domElement");e("width");e("height");e("frameCount");e("key");e("keyCode");e("mouseX");e("mouseY");e("pmouseX");e("pmouseY");e("mousePressed");e=function(){};b.loop=true;
b.keyup=e;b.keydown=e;b.draw=e;b.mousedown=e;b.mouseup=e;b.mousemove=e;b.mousedrag=e;b.__defineGetter__("frameRate",function(){return 1E3/j});b.__defineGetter__("frameTime",function(){return j});b.__defineGetter__("keyPressed",function(){for(var a in i)if(i[a])return true;return false});b.__defineSetter__("frameTime",function(a){c.desiredFrameTime=a});b.__defineSetter__("frameRate",function(a){c.desiredFrameTime=k/a});f.addEventListener("mouseenter",function(){h()},false);var l=function(){b.mousemove()};
f.addEventListener("mousemove",function(a){var g=a.pageX-offset.x;a=a.pageY-offset.y;if(c.pmouseX==undefined){c.pmouseX=g;c.pmouseY=a}else{c.pmouseX=c.mouseX;c.pmouseY=c.mouseY}c.mouseX=g;c.mouseY=a},false);f.addEventListener("mousemove",l,false);f.addEventListener("mousedown",function(){c.mousePressed=true;b.mousedown();f.addEventListener("mousemove",b.mousedrag,false);f.removeEventListener("mousemove",l,false)},false);f.addEventListener("mouseup",function(){c.mousePressed=false;b.mouseup();f.removeEventListener("mousemove",
b.mousedrag,false);f.addEventListener("mousemove",l,false)},false);window.addEventListener("keydown",function(a){a=a.keyCode;c.key=String.fromCharCode(a);c.keyCode=a;i[a]=true;b.keydown()},false);window.addEventListener("keyup",function(a){a=a.keyCode;c.key=String.fromCharCode(a);c.keyCode=a;i[a]=false;b.keyup()},false);var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(a){window.setTimeout(a,j)}}();_idraw=function(){b.loop&&n(_idraw);c.frameCount++;var a=(new Date).getTime();b.draw();a=(new Date).getTime()-a;j=a>c.desiredFrameTime?a:c.desiredFrameTime};_idraw()}}else d.fallback&&d.fallback()};

